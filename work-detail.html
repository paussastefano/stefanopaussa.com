<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Project - Stefano Paussa</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="page-header">
        <nav class="page-nav">
            <a href="home.html" class="nav-item">Stefano Paussa</a>
            <a href="works.html" class="nav-item active">Works</a>
            <a href="photography.html" class="nav-item">Photography</a>
            <a href="about.html" class="nav-item">About</a>
        </nav>
    </header>

    <main class="work-detail-main">
        <a href="works.html" class="back-link">&larr; Back to Works</a>

        <article class="work-detail" id="work-detail">
            <!-- Project will be loaded dynamically from JSON -->
        </article>
    </main>

    <script>
        // Get project ID from URL
        function getProjectId() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id');
        }

        // Load project data
        async function loadProject() {
            const projectId = getProjectId();

            if (!projectId) {
                window.location.href = 'works.html';
                return;
            }

            try {
                const response = await fetch('data/projects.json');
                const projects = await response.json();
                const project = projects.find(p => p.id === projectId);

                if (project) {
                    renderProject(project);
                } else {
                    window.location.href = 'works.html';
                }
            } catch (error) {
                console.error('Error loading project:', error);
                window.location.href = 'works.html';
            }
        }

        // Render project details
        function renderProject(project) {
            // Update page title
            document.getElementById('page-title').textContent = `${project.title} - Stefano Paussa`;

            // Build credits HTML
            const creditsHTML = project.credits.map(credit =>
                `<li><strong>${credit.role}:</strong> ${credit.name}</li>`
            ).join('');

            // Build video or image section
            let mediaHTML = '';
            if (project.videoUrl) {
                mediaHTML = `
                    <div class="video-wrapper">
                        <iframe
                            src="${project.videoUrl}"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    </div>
                `;
            } else if (project.category === 'photography') {
                mediaHTML = `
                    <div class="photo-wrapper">
                        <img src="${project.thumbnail}" alt="${project.title}">
                    </div>
                `;
            }

            // Render full project
            const detailContainer = document.getElementById('work-detail');
            detailContainer.innerHTML = `
                ${mediaHTML}

                <div class="work-info">
                    <h2 class="work-detail-title">${project.title}</h2>

                    <section class="work-description">
                        <h3>Description</h3>
                        <p>${project.description}</p>
                    </section>

                    <section class="work-credits">
                        <h3>Credits</h3>
                        <ul>
                            ${creditsHTML}
                        </ul>
                    </section>
                </div>
            `;
        }

        // Load project on page load
        loadProject();
    </script>
</body>
</html>
